{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rmcoo\\\\OneDrive\\\\Documents\\\\GitHub\\\\CST-326\\\\DPE\\\\frontend\\\\src\\\\Pages\\\\loginSignup\\\\Login.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport { userLogin, fetchUserData, cartItems } from '../../api/authenticationService';\nimport { useNavigate } from 'react-router-dom';\nimport { authenticate, authFailure, authSuccess, userInfoLost, userInfoFetched, cartItemCount } from '../../redux/authActions';\nimport { useDispatch, useSelector } from 'react-redux';\nimport './login.css';\nconst Login = () => {\n  const state = useSelector(state => state);\n  const dispatch = useDispatch();\n  const history = useNavigate();\n  const [loginData, setLoginData] = useState({\n    userName: '',\n    password: ''\n  });\n  const handleSubmit = evt => {\n    evt.preventDefault();\n    dispatch(authenticate());\n    userLogin(loginData).then(response => {\n      if (response.status === 200) {\n        dispatch(authSuccess(response.data));\n        fetchUserData().then(response => {\n          const data = response.data;\n          localStorage.setItem(\"UserData\", JSON.stringify(data));\n          dispatch(userInfoFetched(response.data));\n          response.data.roles.forEach(e => {\n            if (e.authority === 'USER') {\n              cartItems(response.data.userId).then(res => {\n                dispatch(cartItemCount(res.data.length));\n              });\n            }\n          });\n          console.log(response.data);\n          history('/home');\n        }).catch(e => {\n          dispatch(userInfoLost());\n          alert(\"You have to login first...\");\n          history('/');\n        });\n      } else {\n        dispatch(authFailure('Something Wrong!Please Try Again'));\n      }\n    }).catch(err => {\n      if (err && err.response) {\n        switch (err.response.status) {\n          case 401:\n            console.log(\"401 status\");\n            dispatch(authFailure(\"Authentication Failed.Bad Credentials\"));\n            break;\n          default:\n            dispatch(authFailure('Something Wrong!Please Try Again'));\n        }\n      } else {\n        dispatch(authFailure('Something Wrong!Please Try Again'));\n      }\n    });\n  };\n  const handleChange = e => {\n    e.persist();\n    setLoginData(values => ({\n      ...values,\n      [e.target.name]: e.target.value\n    }));\n  };\n  const logOut = () => {\n    localStorage.clear();\n    dispatch(userInfoLost());\n    history('/');\n  };\n  const signup = () => {\n    localStorage.clear();\n    dispatch(userInfoLost());\n    history('/signup');\n  };\n  useEffect(() => {\n    logOut();\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      minHeight: \"80vh\"\n    },\n    className: \"col-8 mx-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-secondary ms-3 my-3\",\n    onClick: signup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }, \"Signup\"), /*#__PURE__*/React.createElement(\"form\", {\n    className: \" gx-3 gy-2 align-items-center w-100 p-3\",\n    onSubmit: handleSubmit,\n    noValidate: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-6 mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input-group-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 25\n    }\n  }, \"Username\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    id: \"userName\",\n    name: \"userName\",\n    value: loginData.userName,\n    onChange: handleChange,\n    placeholder: \"Username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-6 mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input-group-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 25\n    }\n  }, \"Password\\xA0\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    className: \"form-control\",\n    id: \"password\",\n    name: \"password\",\n    value: loginData.password,\n    onChange: handleChange,\n    placeholder: \"Password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-auto mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 21\n    }\n  }, \"Submit\"), state.loading && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"ms-2 fw-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 25\n    }\n  }, \"Loading...\"))));\n};\nexport default Login;","map":{"version":3,"names":["React","useEffect","useState","userLogin","fetchUserData","cartItems","useNavigate","authenticate","authFailure","authSuccess","userInfoLost","userInfoFetched","cartItemCount","useDispatch","useSelector","Login","state","dispatch","history","loginData","setLoginData","userName","password","handleSubmit","evt","preventDefault","then","response","status","data","localStorage","setItem","JSON","stringify","roles","forEach","e","authority","userId","res","length","console","log","catch","alert","err","handleChange","persist","values","target","name","value","logOut","clear","signup","createElement","style","minHeight","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onSubmit","noValidate","type","id","onChange","placeholder","loading"],"sources":["C:/Users/rmcoo/OneDrive/Documents/GitHub/CST-326/DPE/frontend/src/Pages/loginSignup/Login.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { userLogin, fetchUserData, cartItems } from '../../api/authenticationService';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { authenticate, authFailure, authSuccess, userInfoLost, userInfoFetched, cartItemCount } from '../../redux/authActions';\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport './login.css';\r\n\r\n\r\nconst Login = () => {\r\n    const state = useSelector((state) => state);\r\n    const dispatch = useDispatch();\r\n    const history = useNavigate();\r\n    const [loginData, setLoginData] = useState({\r\n        userName: '',\r\n        password: ''\r\n    });\r\n\r\n\r\n    const handleSubmit = (evt) => {\r\n        evt.preventDefault();\r\n        dispatch(authenticate());\r\n        userLogin(loginData).then((response) => {\r\n            if (response.status === 200) {\r\n                dispatch(authSuccess(response.data));\r\n                fetchUserData().then((response) => {\r\n                    const data = response.data;\r\n                    localStorage.setItem(\"UserData\", JSON.stringify(data));\r\n                    dispatch(userInfoFetched(response.data));\r\n\r\n                    response.data.roles.forEach(e => {\r\n                        if (e.authority === 'USER') {\r\n                            cartItems(response.data.userId).then(res => {\r\n                                dispatch(cartItemCount(res.data.length));\r\n                            })\r\n                        }\r\n                    })\r\n                    console.log(response.data);\r\n                    history('/home')\r\n                }).catch((e) => {\r\n                    dispatch(userInfoLost());\r\n                    alert(\"You have to login first...\")\r\n                    history('/')\r\n                })\r\n            }\r\n            else {\r\n                dispatch(authFailure('Something Wrong!Please Try Again'));\r\n            }\r\n        }).catch((err) => {\r\n            if (err && err.response) {\r\n                switch (err.response.status) {\r\n                    case 401:\r\n                        console.log(\"401 status\");\r\n                        dispatch(authFailure(\"Authentication Failed.Bad Credentials\"));\r\n                        break;\r\n                    default:\r\n                        dispatch(authFailure('Something Wrong!Please Try Again'));\r\n                }\r\n            }\r\n            else {\r\n                dispatch(authFailure('Something Wrong!Please Try Again'));\r\n            }\r\n        });\r\n    }\r\n    const handleChange = (e) => {\r\n        e.persist();\r\n        setLoginData(values => ({\r\n            ...values,\r\n            [e.target.name]: e.target.value\r\n        }));\r\n    };\r\n    const logOut = () => {\r\n        localStorage.clear();\r\n        dispatch(userInfoLost());\r\n        history('/');\r\n    }\r\n    const signup = () => {\r\n        localStorage.clear();\r\n        dispatch(userInfoLost());\r\n        history('/signup');\r\n    }\r\n\r\n    useEffect(() => {\r\n        logOut();\r\n    }, []);\r\n\r\n    return (\r\n        <div style={{ minHeight: \"80vh\" }} className='col-8 mx-auto'>\r\n            <button className='btn btn-secondary ms-3 my-3' onClick={signup} >Signup</button>\r\n            <form className=\" gx-3 gy-2 align-items-center w-100 p-3\" onSubmit={handleSubmit} noValidate={false}>\r\n\r\n                <div className=\"col-sm-6 mt-3\">\r\n                    <div className=\"input-group\">\r\n                        <div className=\"input-group-text\">Username</div>\r\n                        <input type=\"text\" className=\"form-control\" id=\"userName\" name='userName' value={loginData.userName} onChange={handleChange} placeholder=\"Username\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"col-sm-6 mt-3\">\r\n                    <div className=\"input-group\">\r\n                        <div className=\"input-group-text\">Password&nbsp;</div>\r\n                        <input type=\"password\" className=\"form-control\" id=\"password\" name='password' value={loginData.password} onChange={handleChange} placeholder=\"Password\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"col-auto mt-3\">\r\n                    <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\r\n                    {state.loading && (\r\n                        <span className=\"ms-2 fw-bold\">Loading...</span>\r\n                    )}\r\n\r\n                </div>\r\n\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module"}